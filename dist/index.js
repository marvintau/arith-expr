!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.arithExpr=e():t.arithExpr=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const{get:n,add:o}=r(1),c=r(2);t.exports=((t,e,r={},o="ccode_name")=>(c.varTable=e,c.data=r,c.get=n,c.column=o,c.parse(t)))},function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e){
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
function r(t){return 1==(null!=(e=t)&&"object"==typeof e&&!1===Array.isArray(e))&&"[object Object]"===Object.prototype.toString.call(t);
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var e}const n=(t,e,r="PRE")=>{if(!["POST","PRE"].includes(r))throw{code:"INVLAID_TRAV_ORDER",from:"trav"};for(let o=0;o<t.length;o++){let c=t[o];"PRE"===r&&e(c,o),Array.isArray(c.__children)&&n(c.__children,e,r),"POST"===r&&e(c,o)}};t.exports={isPlainObject:function(t){var e,n;return!1!==r(t)&&"function"==typeof(e=t.constructor)&&!1!==r(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")},isInteger:t=>"number"==typeof t&&t%1==0,trav:n}},function(t,e,r){const{isInteger:n}=r(0);t.exports=((t,{path:e,column:r,withList:o=!1}={})=>{if(void 0===e)throw{code:"PATH_NOT_PROVIDED",from:"get"};let c;if(Array.isArray(e)&&e.every(n))c=((t,{path:e,withList:r})=>{let n,o,c=t;r&&(o=[]);for(let t=0;t<e.length&&void 0!==(n=c[e[t]]);t++)r&&o.push(n),c=n.__children||[];return{record:n,siblings:c,list:o}})(t,{path:e,withList:o});else{if(void 0===r)throw{code:"INVALID_PATH",from:"get"};c=((t,{path:e,column:r,withList:n}={})=>{let o,c,u=t;n&&(c=[]);for(let t=0;t<e.length&&void 0!==(o=u.find(({[r]:n})=>n===e[t]));t++)n&&c.push(o),t<e.length-1&&(u=o.__children||[]);return{record:o,siblings:u,list:c}})(t,{path:e,column:r,withList:o})}return c})},function(t,e,r){const n=r(3),o=r(4),c=r(5),u=r(6),{trav:i}=r(0),a=r(1),l=r(7),f=r(8);t.exports={add:l,del:f,get:a,sort:c,flat:u,trav:i,group:o,pathify:n}},function(t,e,r){const{trav:n}=r(0);t.exports=(t=>(n(t,(t,e)=>{void 0===t.__path&&Object.defineProperty(t,"__path",{value:[e]});const r=t.__children;if(void 0!==r)for(let e=0;e<r.length;e++)void 0===r[e].__path&&Object.defineProperty(r[e],"__path",{value:[...t.__path,e]})},"PRE"),[...t]))},function(t,e){t.exports=function(t,e){let r={};if(void 0===e)throw{code:"KEY_NOT_PROVIDED",from:"group"};const n=e.constructor===Function?t=>e(t):t=>t[e];for(let e=0;e<t.length;e++){const o=t[e],c=n(o);!(c in r)&&(r[c]=[]),r[c].push(o)}return r}},function(t,e,r){const{trav:n}=r(0);t.exports=((t,e)=>{const r=e.constructor===Function?t=>e(t):t=>t[e];return n(t,t=>{void 0!==t.__children&&t.__children.sort((t,e)=>{const n=r(t),o=r(e);return n>o?1:n<o?-1:0})},"POST"),[...t]})},function(t,e){t.exports=(t=>{const e=[...t],r=[];for(;e.length;){const t=e.shift();t.__children&&e.unshift(...t.__children),r.push(t)}return r})},function(t,e,r){const{isInteger:n,isPlainObject:o}=r(0),c=r(1),u=(t,e,r)=>{if(Array.isArray(e)&&e.every(o))n(r)?t.splice(r,...e):t.push(...e);else{if(!o(e))throw{code:"INVALID_REC",from:"add"};n(r)?t.splice(r,e):t.push(e)}return[...t]};t.exports=((t,e,{path:r=[],column:n,atIndex:o}={})=>{if(0===r.length)return u(t,e);{const{record:i}=c(t,{path:r,column:n});return void 0===i.__children&&Object.defineProperty(i,"__children",{value:[]}),u(i.__children,e,o)}})},function(t,e,r){const{isInteger:n}=r(0),o=r(1),c=(t,e,r)=>{n(e)?t.splice(e,r):n(r)?t.splice(t.length-r,r):t.pop()};t.exports=((t,{atIndex:e,num:r,path:n=[],column:u}={})=>{if(0===n.length)c(t,e,r);else{const{record:i}=o(t,{path:n,column:u});c(i.__children||[],e,r)}return[...t]})}])},function(t,e,r){"use strict";function n(t,e,r,o){this.message=t,this.expected=e,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(n,Error),n.buildMessage=function(t,e){var r={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?c(t.parts[e][0])+"-"+c(t.parts[e][1]):c(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function c(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}return"Expected "+function(t){var e,n,o,c=new Array(t.length);for(e=0;e<t.length;e++)c[e]=(o=t[e],r[o.type](o));if(c.sort(),c.length>0){for(e=1,n=1;e<c.length;e++)c[e-1]!==c[e]&&(c[n]=c[e],n++);c.length=n}switch(c.length){case 1:return c[0];case 2:return c[0]+" or "+c[1];default:return c.slice(0,-1).join(", ")+", or "+c[c.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:n,parse:function(t,e){e=void 0!==e?e:{};var r,o={},c={PathExpr:vt},u=vt,i=":",a=lt(":",!1),l=function(t,e){let r,n,{Sheet:o,Path:c,Var:u}=at;if(o)r=o,n=0;else if(c)r=c,n=0;else if(c)r=c,n=0;else if(0===e.length)r="INCOMPLETE_REFERENCE_FORMAT",n=0;else if(u)r=at.Var.code,n=0;else{const{result:t,code:o}=e[0][1];n=t,r=o}return{siblings:t,result:n,code:r}},f=function(){const t=it();void 0===wt[t]?at.Sheet="SHEET_NOT_EXISTS":Et=wt[t]},s="/",p=lt("/",!1),h=function(t,e){if(at.Sheet)return void(at.Path=at.Sheet);const r=e.reduce((t,e)=>t.concat(e[1]),[t]),{record:n,siblings:o}=jt(Et,{path:r,column:Ct});return void 0!==n?Object.assign(St,Pt,n):at.Path="RECORD_NOT_FOUND",o},d="===",g=lt("===",!1),v=function(t,e){return at.Var?{result:0,code:at.Var}:{result:t===e?"EQUAL":Math.abs(t-e)}},_="+",y=lt("+",!1),A="-",b=lt("-",!1),x=function(t,e){return at.Var?{result:0,code:at.Var}:{result:e.reduce(function(t,e){switch(e[1]){case"+":return t+e[3];case"-":return t-e[3]}},t||0)}},m="*",O=lt("*",!1),E=function(t,e){return e.reduce(function(t,e){switch(e[1]){case"*":return t*e[3];case"/":return t/e[3]}},t)},P="(",w=lt("(",!1),j=")",C=lt(")",!1),S=function(t){return t.result},T=st("variable"),R="$",F=lt("$",!1),I=function(t){return t in St?St[t]:(at.Var={code:"VAR_NOT_FOUND",varNme:t},0)},V=st("literal"),M=/^[A-Za-z\u4E00-\u9FA5]/,N=ft([["A","Z"],["a","z"],["一","龥"]],!1,!1),D=/^[A-Za-z0-9\u4E00-\u9FA5_]/,L=ft([["A","Z"],["a","z"],["0","9"],["一","龥"],"_"],!1,!1),z=function(){return it()},U=st("real"),Z=".",H=lt(".",!1),k=/^[eE]/,$=ft(["e","E"],!1,!1),K=/^[+\-]/,Q=ft(["+","-"],!1,!1),X=function(){return parseFloat(it())},Y=st("integer"),q=/^[0-9]/,B=ft([["0","9"]],!1,!1),G=function(){return parseInt(it(),10)},J=st("whitespace"),W=/^[ \t\n\r]/,tt=ft([" ","\t","\n","\r"],!1,!1),et=0,rt=0,nt=[{line:1,column:1}],ot=0,ct=[],ut=0;if("startRule"in e){if(!(e.startRule in c))throw new Error("Can't start parsing from rule \""+e.startRule+'".');u=c[e.startRule]}function it(){return t.substring(rt,et)}function at(t,e){throw function(t,e){return new n(t,null,null,e)}(t,e=void 0!==e?e:ht(rt,et))}function lt(t,e){return{type:"literal",text:t,ignoreCase:e}}function ft(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function st(t){return{type:"other",description:t}}function pt(e){var r,n=nt[e];if(n)return n;for(r=e-1;!nt[r];)r--;for(n={line:(n=nt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return nt[e]=n,n}function ht(t,e){var r=pt(t),n=pt(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function dt(t){et<ot||(et>ot&&(ot=et,ct=[]),ct.push(t))}function gt(t,e,r){return new n(n.buildMessage(t,e),t,e,r)}function vt(){var e,r,n,c,u,d,g;if(e=et,function(){var t,e;return t=et,(e=xt())!==o&&(rt=t,e=f()),t=e}()!==o)if(58===t.charCodeAt(et)?(r=i,et++):(r=o,0===ut&&dt(a)),r!==o)if((n=function(){var e,r,n,c,u,i;if(e=et,(r=xt())!==o){for(n=[],c=et,47===t.charCodeAt(et)?(u=s,et++):(u=o,0===ut&&dt(p)),u!==o&&(i=xt())!==o?c=u=[u,i]:(et=c,c=o);c!==o;)n.push(c),c=et,47===t.charCodeAt(et)?(u=s,et++):(u=o,0===ut&&dt(p)),u!==o&&(i=xt())!==o?c=u=[u,i]:(et=c,c=o);n!==o?(rt=e,r=h(r,n),e=r):(et=e,e=o)}else et=e,e=o;return e}())!==o){for(c=[],u=et,58===t.charCodeAt(et)?(d=i,et++):(d=o,0===ut&&dt(a)),d!==o&&(g=_t())!==o?u=d=[d,g]:(et=u,u=o);u!==o;)c.push(u),u=et,58===t.charCodeAt(et)?(d=i,et++):(d=o,0===ut&&dt(a)),d!==o&&(g=_t())!==o?u=d=[d,g]:(et=u,u=o);c!==o?(rt=e,e=l(n,c)):(et=e,e=o)}else et=e,e=o;else et=e,e=o;else et=e,e=o;return e===o&&(e=_t()),e}function _t(){var e;return(e=function(){var e,r,n,c;return e=et,(r=bt())!==o&&Ot()!==o?(t.substr(et,3)===d?(n=d,et+=3):(n=o,0===ut&&dt(g)),n!==o&&Ot()!==o&&(c=bt())!==o?(rt=e,r=v(r,c),e=r):(et=e,e=o)):(et=e,e=o),e}())===o&&(e=yt()),e}function yt(){var e,r,n,c,u,i,a,l;if(e=et,(r=At())===o&&(r=null),r!==o){for(n=[],c=et,(u=Ot())!==o?(43===t.charCodeAt(et)?(i=_,et++):(i=o,0===ut&&dt(y)),i===o&&(45===t.charCodeAt(et)?(i=A,et++):(i=o,0===ut&&dt(b))),i!==o&&(a=Ot())!==o&&(l=At())!==o?c=u=[u,i,a,l]:(et=c,c=o)):(et=c,c=o);c!==o;)n.push(c),c=et,(u=Ot())!==o?(43===t.charCodeAt(et)?(i=_,et++):(i=o,0===ut&&dt(y)),i===o&&(45===t.charCodeAt(et)?(i=A,et++):(i=o,0===ut&&dt(b))),i!==o&&(a=Ot())!==o&&(l=At())!==o?c=u=[u,i,a,l]:(et=c,c=o)):(et=c,c=o);n!==o?(rt=e,e=r=x(r,n)):(et=e,e=o)}else et=e,e=o;return e}function At(){var e,r,n,c,u,i,a,l;if(e=et,(r=bt())!==o){for(n=[],c=et,(u=Ot())!==o?(42===t.charCodeAt(et)?(i=m,et++):(i=o,0===ut&&dt(O)),i===o&&(47===t.charCodeAt(et)?(i=s,et++):(i=o,0===ut&&dt(p))),i!==o&&(a=Ot())!==o&&(l=bt())!==o?c=u=[u,i,a,l]:(et=c,c=o)):(et=c,c=o);c!==o;)n.push(c),c=et,(u=Ot())!==o?(42===t.charCodeAt(et)?(i=m,et++):(i=o,0===ut&&dt(O)),i===o&&(47===t.charCodeAt(et)?(i=s,et++):(i=o,0===ut&&dt(p))),i!==o&&(a=Ot())!==o&&(l=bt())!==o?c=u=[u,i,a,l]:(et=c,c=o)):(et=c,c=o);n!==o?(rt=e,e=r=E(r,n)):(et=e,e=o)}else et=e,e=o;return e}function bt(){var e,r,n,c;return e=et,40===t.charCodeAt(et)?(r=P,et++):(r=o,0===ut&&dt(w)),r!==o&&Ot()!==o&&(n=yt())!==o&&Ot()!==o?(41===t.charCodeAt(et)?(c=j,et++):(c=o,0===ut&&dt(C)),c!==o?(rt=e,e=r=S(n)):(et=e,e=o)):(et=e,e=o),e===o&&(e=function(){var e,r,n,c,u;if(ut++,e=et,(r=Ot())!==o)if(36===t.charCodeAt(et)?(n=R,et++):(n=o,0===ut&&dt(F)),n!==o){for(c=[],u=xt();u!==o;)c.push(u),u=xt();c!==o?(rt=e,r=I(c),e=r):(et=e,e=o)}else et=e,e=o;else et=e,e=o;return ut--,e===o&&(r=o,0===ut&&dt(T)),e}())===o&&(e=function(){var e,r,n,c,u,i,a,l,f;return ut++,e=et,(r=Ot())!==o&&mt()!==o?(n=et,46===t.charCodeAt(et)?(c=Z,et++):(c=o,0===ut&&dt(H)),c!==o&&(u=mt())!==o?(i=et,k.test(t.charAt(et))?(a=t.charAt(et),et++):(a=o,0===ut&&dt($)),a!==o?(K.test(t.charAt(et))?(l=t.charAt(et),et++):(l=o,0===ut&&dt(Q)),l!==o&&(f=mt())!==o?i=a=[a,l,f]:(et=i,i=o)):(et=i,i=o),i===o&&(i=null),i!==o?n=c=[c,u,i]:(et=n,n=o)):(et=n,n=o),n===o&&(n=null),n!==o?(rt=e,r=X(),e=r):(et=e,e=o)):(et=e,e=o),ut--,e===o&&(r=o,0===ut&&dt(U)),e}())===o&&(e=mt()),e}function xt(){var e,r,n,c;if(ut++,e=et,M.test(t.charAt(et))?(r=t.charAt(et),et++):(r=o,0===ut&&dt(N)),r!==o){for(n=[],D.test(t.charAt(et))?(c=t.charAt(et),et++):(c=o,0===ut&&dt(L));c!==o;)n.push(c),D.test(t.charAt(et))?(c=t.charAt(et),et++):(c=o,0===ut&&dt(L));n!==o?(rt=e,e=r=z()):(et=e,e=o)}else et=e,e=o;return ut--,e===o&&(r=o,0===ut&&dt(V)),e}function mt(){var e,r,n;if(ut++,e=et,Ot()!==o){if(r=[],q.test(t.charAt(et))?(n=t.charAt(et),et++):(n=o,0===ut&&dt(B)),n!==o)for(;n!==o;)r.push(n),q.test(t.charAt(et))?(n=t.charAt(et),et++):(n=o,0===ut&&dt(B));else r=o;r!==o?(rt=e,e=G()):(et=e,e=o)}else et=e,e=o;return ut--,e===o&&0===ut&&dt(Y),e}function Ot(){var e,r;for(ut++,e=[],W.test(t.charAt(et))?(r=t.charAt(et),et++):(r=o,0===ut&&dt(tt));r!==o;)e.push(r),W.test(t.charAt(et))?(r=t.charAt(et),et++):(r=o,0===ut&&dt(tt));return ut--,e===o&&(r=o,0===ut&&dt(J)),e}var Et,{varTable:Pt={},data:wt={},get:jt,column:Ct}=this,St={...Pt},at={};if((r=u())!==o&&et===t.length)return r;throw r!==o&&et<t.length&&dt({type:"end"}),gt(ct,ot<t.length?t.charAt(ot):null,ot<t.length?ht(ot,ot+1):ht(ot,ot))}}}])});