!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.arithExpr=e():t.arithExpr=e()}(window,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=0)}([function(t,e,r){const{get:n}=r(1),o=r(2);t.exports=((t,{func:e={},data:r={},column:u="ccode_name"}={})=>(Object.assign(o,{func:e,data:r,column:u,get:n}),o.parse(t)))},function(t,e,r){window,t.exports=function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=2)}([function(t,e){
/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */
function r(t){return 1==(null!=(e=t)&&"object"==typeof e&&!1===Array.isArray(e))&&"[object Object]"===Object.prototype.toString.call(t);
/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var e}const n=(t,e,r="PRE")=>{if(!["POST","PRE"].includes(r))throw{code:"INVLAID_TRAV_ORDER",from:"trav"};for(let o=0;o<t.length;o++){let u=t[o];"PRE"===r&&e(u,o),Array.isArray(u.__children)&&n(u.__children,e,r),"POST"===r&&e(u,o)}};t.exports={isPlainObject:function(t){var e,n;return!1!==r(t)&&"function"==typeof(e=t.constructor)&&!1!==r(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")},isInteger:t=>"number"==typeof t&&t%1==0,trav:n}},function(t,e,r){const{isInteger:n}=r(0);t.exports=((t,{path:e,column:r,withList:o=!1}={})=>{if(void 0===e)throw{code:"PATH_NOT_PROVIDED",from:"get"};let u;if(Array.isArray(e)&&e.every(n))u=((t,{path:e,withList:r})=>{let n,o,u=t;r&&(o=[]);for(let t=0;t<e.length&&void 0!==(n=u[e[t]]);t++)r&&o.push(n),u=n.__children||[];return{record:n,siblings:u,list:o}})(t,{path:e,withList:o});else{if(void 0===r)throw{code:"INVALID_PATH",from:"get"};u=((t,{path:e,column:r,withList:n}={})=>{let o,u,c=t;n&&(u=[]);for(let t=0;t<e.length&&void 0!==(o=c.find(({[r]:n})=>n===e[t]));t++)n&&u.push(o),t<e.length-1&&(c=o.__children||[]);return{record:o,siblings:c,list:u}})(t,{path:e,column:r,withList:o})}return u})},function(t,e,r){const n=r(3),o=r(4),u=r(5),c=r(6),{trav:i}=r(0),a=r(1),l=r(7),f=r(8);t.exports={add:l,del:f,get:a,sort:u,flat:c,trav:i,group:o,pathify:n}},function(t,e,r){const{trav:n}=r(0);t.exports=(t=>(n(t,(t,e)=>{void 0===t.__path&&Object.defineProperty(t,"__path",{value:[e]});const r=t.__children;if(void 0!==r)for(let e=0;e<r.length;e++)void 0===r[e].__path&&Object.defineProperty(r[e],"__path",{value:[...t.__path,e]})},"PRE"),[...t]))},function(t,e){t.exports=function(t,e){let r={};if(void 0===e)throw{code:"KEY_NOT_PROVIDED",from:"group"};const n=e.constructor===Function?t=>e(t):t=>t[e];for(let e=0;e<t.length;e++){const o=t[e],u=n(o);!(u in r)&&(r[u]=[]),r[u].push(o)}return r}},function(t,e,r){const{trav:n}=r(0);t.exports=((t,e)=>{const r=e.constructor===Function?t=>e(t):t=>t[e];return n(t,t=>{void 0!==t.__children&&t.__children.sort((t,e)=>{const n=r(t),o=r(e);return n>o?1:n<o?-1:0})},"POST"),[...t]})},function(t,e){t.exports=(t=>{const e=[...t],r=[];for(;e.length;){const t=e.shift();t.__children&&e.unshift(...t.__children),r.push(t)}return r})},function(t,e,r){const{isInteger:n,isPlainObject:o}=r(0),u=r(1),c=(t,e,r)=>{if(Array.isArray(e)&&e.every(o))n(r)?t.splice(r,...e):t.push(...e);else{if(!o(e))throw{code:"INVALID_REC",from:"add"};n(r)?t.splice(r,e):t.push(e)}return[...t]};t.exports=((t,e,{path:r=[],column:n,atIndex:o}={})=>{if(0===r.length)return c(t,e);{const{record:i}=u(t,{path:r,column:n});return void 0===i.__children&&Object.defineProperty(i,"__children",{value:[]}),c(i.__children,e,o)}})},function(t,e,r){const{isInteger:n}=r(0),o=r(1),u=(t,e,r)=>{n(e)?t.splice(e,r):n(r)?t.splice(t.length-r,r):t.pop()};t.exports=((t,{atIndex:e,num:r,path:n=[],column:c}={})=>{if(0===n.length)u(t,e,r);else{const{record:i}=o(t,{path:n,column:c});u(i.__children||[],e,r)}return[...t]})}])},function(t,e,r){"use strict";function n(t,e,r,o){this.message=t,this.expected=e,this.found=r,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(n,Error),n.buildMessage=function(t,e){var r={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var e,r="";for(e=0;e<t.parts.length;e++)r+=t.parts[e]instanceof Array?u(t.parts[e][0])+"-"+u(t.parts[e][1]):u(t.parts[e]);return"["+(t.inverted?"^":"")+r+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function u(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}return"Expected "+function(t){var e,n,o,u=new Array(t.length);for(e=0;e<t.length;e++)u[e]=(o=t[e],r[o.type](o));if(u.sort(),u.length>0){for(e=1,n=1;e<u.length;e++)u[e-1]!==u[e]&&(u[n]=u[e],n++);u.length=n}switch(u.length){case 1:return u[0];case 2:return u[0]+" or "+u[1];default:return u.slice(0,-1).join(", ")+", or "+u[u.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:n,parse:function(t,e){e=void 0!==e?e:{};var r,o={},u={VarExpr:Ct},c=Ct,i="@",a=vt("@",!1),l=function(t,e){Ut[t]=e.result},f="=",s=vt("=",!1),p="(",h=vt("(",!1),d=")",g=vt(")",!1),A=function(t,e){return t in Vt?{result:Vt[t](e)}:{result:0,code:"UNDEFINED_FUNC"}},_=":",v=vt(":",!1),y=function(t,e){let r,{Sheet:n,Path:o,Var:u}=_t,c=0;if(n)r=n;else if(o)r=o;else if(0===e.length)r="INCOMPLETE_REFERENCE_FORMAT";else if(u)r=_t.Var.code;else{const{result:t,code:n}=e[0][1];c=t,r=n}return{siblings:t,result:c,code:r}},m=function(){const t=At();void 0===Mt[t]?_t.Sheet="SHEET_NOT_EXISTS":Nt=Mt[t]},b="/",x=vt("/",!1),O=function(t,e){if(_t.Sheet)return void(_t.Path=_t.Sheet);const r=e.reduce((t,e)=>t.concat(e[1]),[t]);let{record:n,siblings:o}=Dt(Nt,{path:r,column:Lt});if(void 0!==n)return Zt={...Ut,...n},o;{const t=kt(r.map(t=>t in Ht?Ht[t]:[t]));for(let e of t){let{record:t,siblings:r}=Dt(Nt,{path:e,column:Lt});if(void 0!==t)return Zt={...Ut,...t},r}return _t.Path="RECORD_NOT_FOUND",o}},E="===",C=vt("===",!1),P=function(t,e){return _t.Var?{result:0,code:_t.Var}:{result:t===e?"EQUAL":Math.abs(t-e)}},w="+",S=vt("+",!1),j="-",R=vt("-",!1),T=function(t,e){return _t.Var?{result:0,code:_t.Var}:{result:e.reduce(function(t,e){switch(e[1]){case"+":return t+e[3];case"-":return t-e[3]}},t||0)}},F="*",I=vt("*",!1),N=function(t,e){return e.reduce(function(t,e){switch(e[1]){case"*":return t*e[3];case"/":return t/e[3]}},t)},V=function(t){return t.result},M=mt("variable"),D="$",L=vt("$",!1),U=function(t){return t in Zt?Zt[t]:zt[t]in Zt?Zt[zt[t]]:(_t.Var={code:"VAR_NOT_FOUND",varName:t[0]},0)},z=mt("literal"),H=/^[A-Za-z\u4E00-\u9FA5]/,Z=yt([["A","Z"],["a","z"],["一","龥"]],!1,!1),k=/^[A-Za-z0-9\u4E00-\u9FA5_]/,$=yt([["A","Z"],["a","z"],["0","9"],["一","龥"],"_"],!1,!1),K=function(){return At()},Q=mt("real number"),X=".",Y=vt(".",!1),q=/^[eE]/,B=yt(["e","E"],!1,!1),G=/^[+\-]/,J=yt(["+","-"],!1,!1),W=function(){return parseFloat(At())},tt=mt("integer"),et=/^[0-9]/,rt=yt([["0","9"]],!1,!1),nt=function(){return parseInt(At(),10)},ot=mt("whitespace"),ut=/^[ \t\n\r]/,ct=yt([" ","\t","\n","\r"],!1,!1),it=mt("wild"),at={type:"any"},lt=function(){return console.log("matched"),{code:"MALFORMED",result:0}},ft=0,st=0,pt=[{line:1,column:1}],ht=0,dt=[],gt=0;if("startRule"in e){if(!(e.startRule in u))throw new Error("Can't start parsing from rule \""+e.startRule+'".');c=u[e.startRule]}function At(){return t.substring(st,ft)}function _t(t,e){throw function(t,e){return new n(t,null,null,e)}(t,e=void 0!==e?e:xt(st,ft))}function vt(t,e){return{type:"literal",text:t,ignoreCase:e}}function yt(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function mt(t){return{type:"other",description:t}}function bt(e){var r,n=pt[e];if(n)return n;for(r=e-1;!pt[r];)r--;for(n={line:(n=pt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return pt[e]=n,n}function xt(t,e){var r=bt(t),n=bt(e);return{start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function Ot(t){ft<ht||(ft>ht&&(ht=ft,dt=[]),dt.push(t))}function Et(t,e,r){return new n(n.buildMessage(t,e),t,e,r)}function Ct(){var e,r,n,u;return e=ft,(r=Tt())!==o?(64===t.charCodeAt(ft)?(n=i,ft++):(n=o,0===gt&&Ot(a)),n!==o&&(u=Pt())!==o?(st=e,e=r=l(r,u)):(ft=e,e=o)):(ft=e,e=o),e===o&&(e=Pt()),e}function Pt(){var e;return(e=function(){var e,r,n,u,c,i,a,l;if(e=ft,(r=function(){var t,e;return t=ft,(e=Tt())!==o&&(st=t,e=m()),t=e}())!==o)if(58===t.charCodeAt(ft)?(n=_,ft++):(n=o,0===gt&&Ot(v)),n!==o)if((u=function(){var e,r,n,u,c,i;if(e=ft,(r=Tt())!==o){for(n=[],u=ft,47===t.charCodeAt(ft)?(c=b,ft++):(c=o,0===gt&&Ot(x)),c!==o&&(i=Tt())!==o?u=c=[c,i]:(ft=u,u=o);u!==o;)n.push(u),u=ft,47===t.charCodeAt(ft)?(c=b,ft++):(c=o,0===gt&&Ot(x)),c!==o&&(i=Tt())!==o?u=c=[c,i]:(ft=u,u=o);n!==o?(st=e,r=O(r,n),e=r):(ft=e,e=o)}else ft=e,e=o;return e}())!==o){for(c=[],i=ft,58===t.charCodeAt(ft)?(a=_,ft++):(a=o,0===gt&&Ot(v)),a!==o&&(l=wt())!==o?i=a=[a,l]:(ft=i,i=o);i!==o;)c.push(i),i=ft,58===t.charCodeAt(ft)?(a=_,ft++):(a=o,0===gt&&Ot(v)),a!==o&&(l=wt())!==o?i=a=[a,l]:(ft=i,i=o);c!==o?(st=e,r=y(u,c),e=r):(ft=e,e=o)}else ft=e,e=o;else ft=e,e=o;else ft=e,e=o;return e}())===o&&(e=function(){var e,r,n,u,c,i;return e=ft,61===t.charCodeAt(ft)?(r=f,ft++):(r=o,0===gt&&Ot(s)),r!==o&&(n=Tt())!==o&&It()!==o?(40===t.charCodeAt(ft)?(u=p,ft++):(u=o,0===gt&&Ot(h)),u!==o&&It()!==o&&(c=Ft())!==o&&It()!==o?(41===t.charCodeAt(ft)?(i=d,ft++):(i=o,0===gt&&Ot(g)),i!==o?(st=e,r=A(n,c),e=r):(ft=e,e=o)):(ft=e,e=o)):(ft=e,e=o),e}())===o&&(e=wt()),e}function wt(){var e;return(e=function(){var e,r,n,u;return e=ft,(r=Rt())!==o&&It()!==o?(t.substr(ft,3)===E?(n=E,ft+=3):(n=o,0===gt&&Ot(C)),n!==o&&It()!==o&&(u=Rt())!==o?(st=e,r=P(r,u),e=r):(ft=e,e=o)):(ft=e,e=o),e}())===o&&(e=St())===o&&(e=function(){var e,r,n;for(gt++,e=ft,r=[],t.length>ft?(n=t.charAt(ft),ft++):(n=o,0===gt&&Ot(at));n!==o;)r.push(n),t.length>ft?(n=t.charAt(ft),ft++):(n=o,0===gt&&Ot(at));return r!==o&&(st=e,r=lt()),gt--,(e=r)===o&&(r=o,0===gt&&Ot(it)),e}()),e}function St(){var e,r,n,u,c,i,a,l;if(e=ft,(r=jt())===o&&(r=null),r!==o){for(n=[],u=ft,(c=It())!==o?(43===t.charCodeAt(ft)?(i=w,ft++):(i=o,0===gt&&Ot(S)),i===o&&(45===t.charCodeAt(ft)?(i=j,ft++):(i=o,0===gt&&Ot(R))),i!==o&&(a=It())!==o&&(l=jt())!==o?u=c=[c,i,a,l]:(ft=u,u=o)):(ft=u,u=o);u!==o;)n.push(u),u=ft,(c=It())!==o?(43===t.charCodeAt(ft)?(i=w,ft++):(i=o,0===gt&&Ot(S)),i===o&&(45===t.charCodeAt(ft)?(i=j,ft++):(i=o,0===gt&&Ot(R))),i!==o&&(a=It())!==o&&(l=jt())!==o?u=c=[c,i,a,l]:(ft=u,u=o)):(ft=u,u=o);n!==o?(st=e,e=r=T(r,n)):(ft=e,e=o)}else ft=e,e=o;return e}function jt(){var e,r,n,u,c,i,a,l;if(e=ft,(r=Rt())!==o){for(n=[],u=ft,(c=It())!==o?(42===t.charCodeAt(ft)?(i=F,ft++):(i=o,0===gt&&Ot(I)),i===o&&(47===t.charCodeAt(ft)?(i=b,ft++):(i=o,0===gt&&Ot(x))),i!==o&&(a=It())!==o&&(l=Rt())!==o?u=c=[c,i,a,l]:(ft=u,u=o)):(ft=u,u=o);u!==o;)n.push(u),u=ft,(c=It())!==o?(42===t.charCodeAt(ft)?(i=F,ft++):(i=o,0===gt&&Ot(I)),i===o&&(47===t.charCodeAt(ft)?(i=b,ft++):(i=o,0===gt&&Ot(x))),i!==o&&(a=It())!==o&&(l=Rt())!==o?u=c=[c,i,a,l]:(ft=u,u=o)):(ft=u,u=o);n!==o?(st=e,e=r=N(r,n)):(ft=e,e=o)}else ft=e,e=o;return e}function Rt(){var e,r,n,u;return e=ft,40===t.charCodeAt(ft)?(r=p,ft++):(r=o,0===gt&&Ot(h)),r!==o&&It()!==o&&(n=St())!==o&&It()!==o?(41===t.charCodeAt(ft)?(u=d,ft++):(u=o,0===gt&&Ot(g)),u!==o?(st=e,e=r=V(n)):(ft=e,e=o)):(ft=e,e=o),e===o&&(e=function(){var e,r,n,u,c;if(gt++,e=ft,(r=It())!==o)if(36===t.charCodeAt(ft)?(n=D,ft++):(n=o,0===gt&&Ot(L)),n!==o){for(u=[],c=Tt();c!==o;)u.push(c),c=Tt();u!==o?(st=e,r=U(u),e=r):(ft=e,e=o)}else ft=e,e=o;else ft=e,e=o;return gt--,e===o&&(r=o,0===gt&&Ot(M)),e}())===o&&(e=function(){var e,r,n,u,c,i,a,l,f;return gt++,e=ft,(r=It())!==o&&Ft()!==o?(n=ft,46===t.charCodeAt(ft)?(u=X,ft++):(u=o,0===gt&&Ot(Y)),u!==o&&(c=Ft())!==o?(i=ft,q.test(t.charAt(ft))?(a=t.charAt(ft),ft++):(a=o,0===gt&&Ot(B)),a!==o?(G.test(t.charAt(ft))?(l=t.charAt(ft),ft++):(l=o,0===gt&&Ot(J)),l!==o&&(f=Ft())!==o?i=a=[a,l,f]:(ft=i,i=o)):(ft=i,i=o),i===o&&(i=null),i!==o?n=u=[u,c,i]:(ft=n,n=o)):(ft=n,n=o),n===o&&(n=null),n!==o?(st=e,r=W(),e=r):(ft=e,e=o)):(ft=e,e=o),gt--,e===o&&(r=o,0===gt&&Ot(Q)),e}())===o&&(e=Ft()),e}function Tt(){var e,r,n,u;if(gt++,e=ft,H.test(t.charAt(ft))?(r=t.charAt(ft),ft++):(r=o,0===gt&&Ot(Z)),r!==o){for(n=[],k.test(t.charAt(ft))?(u=t.charAt(ft),ft++):(u=o,0===gt&&Ot($));u!==o;)n.push(u),k.test(t.charAt(ft))?(u=t.charAt(ft),ft++):(u=o,0===gt&&Ot($));n!==o?(st=e,e=r=K()):(ft=e,e=o)}else ft=e,e=o;return gt--,e===o&&(r=o,0===gt&&Ot(z)),e}function Ft(){var e,r,n;if(gt++,e=ft,It()!==o){if(r=[],et.test(t.charAt(ft))?(n=t.charAt(ft),ft++):(n=o,0===gt&&Ot(rt)),n!==o)for(;n!==o;)r.push(n),et.test(t.charAt(ft))?(n=t.charAt(ft),ft++):(n=o,0===gt&&Ot(rt));else r=o;r!==o?(st=e,e=nt()):(ft=e,e=o)}else ft=e,e=o;return gt--,e===o&&0===gt&&Ot(tt),e}function It(){var e,r;for(gt++,e=[],ut.test(t.charAt(ft))?(r=t.charAt(ft),ft++):(r=o,0===gt&&Ot(ct));r!==o;)e.push(r),ut.test(t.charAt(ft))?(r=t.charAt(ft),ft++):(r=o,0===gt&&Ot(ct));return gt--,e===o&&(r=o,0===gt&&Ot(ot)),e}var Nt,{func:Vt,data:Mt,get:Dt,column:Lt}=this,{__VARS:Ut,__COL_ALIASES:zt={},__PATH_ALIASES:Ht={}}=Mt,Zt={...Ut},_t={};const kt=t=>{if(t.some(t=>!Array.isArray(t)))throw Error("outer必须得用在list of lists上");if(0===t.length)return[];let[e,...r]=t,n=e.map(t=>[t]);for(let t of r)n=n.map(e=>t.map(t=>e.concat(t))).flat();return n};if((r=c())!==o&&ft===t.length)return r;throw r!==o&&ft<t.length&&Ot({type:"end"}),Et(dt,ht<t.length?t.charAt(ht):null,ht<t.length?xt(ht,ht+1):xt(ht,ht))}}}])});